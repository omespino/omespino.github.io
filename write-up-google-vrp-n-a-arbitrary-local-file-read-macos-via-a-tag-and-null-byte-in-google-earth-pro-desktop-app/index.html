<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" media="print" onload="this.onload=null;this.media='all';" id="ao_optimized_gfonts" href="https://fonts.googleapis.com/css?family=Oswald%3A400%2C300%2C700%7CAlegreya+Sans%3A400%2C400italic%2C700%2C700italic%7CDosis%3Ainherit%2C400&#038;subset=latin%2Clatin-ext&amp;display=swap">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<meta name="theme-color" content="#1a1a1a">
<link media="all" href="/wp-content/cache/autoptimize/css/autoptimize_3b05b7efe97d6722f572c298a31dfe97.css" rel="stylesheet">
<title>WRITE UP &#8211; GOOGLE VRP N/A: Arbitrary local file read (macOS) via &lt;a&gt; tag and null byte (%00) in Google Earth Pro Desktop app &#8211; @omespino</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link href="https://fonts.gstatic.com/" crossorigin="anonymous" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="@omespino &raquo; WRITE UP &#8211; GOOGLE VRP N/A: Arbitrary local file read (macOS) via &lt;a&gt; tag and null byte (%00) in Google Earth Pro Desktop app Comments Feed" href="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/feed/">
<link rel="stylesheet" id="mm-compiled-options-mobmenu-css" href="/wp-content/cache/autoptimize/css/autoptimize_single_20b3cf9d88dd6d90b4e4a9a904cb8741.css" type="text/css" media="all"> <script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>  <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-47561535-2" id="google_gtagjs-js" async></script> <link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/1201">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 5.9.3">
<link rel="canonical" href="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/">
<link rel="shortlink" href="/?p=1201">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fwrite-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fwrite-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app%2F&#038;format=xml">
<meta name="generator" content="Site Kit by Google 1.72.0"> <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1119974224835012&ev=PageView&noscript=1"></noscript>
<link rel="icon" href="/wp-content/uploads/2020/12/cropped-dddd-32x32.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2020/12/cropped-dddd-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2020/12/cropped-dddd-180x180.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2020/12/cropped-dddd-270x270.png"> <script src="/wp-content/cache/autoptimize/js/autoptimize_eafcdd70e0cf994d53c6a65b41022ac5.js"></script>
</head>
<body class="post-template-default single single-post postid-1201 single-format-standard custom-background mob-menu-slideout-over">
<div id="page" class="hfeed site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="masthead" class="site-header" role="banner"><div class="navigation-wrapper"><nav id="site-navigation" class="main-navigation" role="navigation"> <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">Menu</button><div class="menu-menu-espanol-container"><ul id="menu-menu-espanol" class="menu"><li id="menu-item-1304" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1304"><a href="/es">BLOG EN ESPAÑOL</a></li></ul></div></nav></div>
<div class="site-branding">
<h1 class="site-title"><a href="/" rel="home">@omespino</a></h1>
<h2 class="site-description">just another security blog.</h2>
</div></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-1201" class="post-1201 post type-post status-publish format-standard hentry category-uncategorized-en"><header class="entry-header"><div class="entry-meta"> <span class="byline"> Written by <span class="author vcard"><a class="url fn n" href="/author/user-admin/">omespino</a></span></span><span class="posted-on"><a href="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/" rel="bookmark"><time class="entry-date published" datetime="2021-10-14T06:38:47-07:00">October 14, 2021</time><time class="updated" datetime="2022-01-07T16:43:38-07:00">January 7, 2022</time></a></span>
</div>
<h1 class="entry-title">WRITE UP &#8211; GOOGLE VRP N/A: Arbitrary local file read (macOS) via &lt;a&gt; tag and null byte (%00) in Google Earth Pro Desktop app</h1></header><div class="entry-wrapper">
<div class="entry-content">
<p><br><strong>Introduction:</strong><br><br>Hi everyone It’s been a while since my last post but I’m back, I want to tell you a very short story about one of my last bugs, and how I managed to get an Arbitrary local macOS file read via &lt;a&gt; tag and null byte (%00) in Google Earth Pro Desktop app <br><br></p>
<p class="has-text-align-center"><em>This blogpost appeared first in the book <a href="/bug-bounty-writeups-collection/" data-type="URL" target="_blank" rel="noreferrer noopener">Bug Bounty Write Ups Collection</a><br></em></p>
<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><a href="/bug-bounty-writeups-collection/" target="_blank" rel="noopener"><img src="/wp-content/uploads/2022/01/BBEBANNER-ENG-1024x772.png" alt="" class="wp-image-1854" width="398" height="301"></a></figure></div>
<p></p>
<p><br><br><strong>Extracted from Google VRP&#8217;s report: (the actual Google VRP report) </strong></p>
<p><em>Summary: Arbitrary local file read (macOS) via &lt;a&gt; and null byte (%00) element in Google Earth Pro Desktop app <br></em><br><em>Steps to reproduce: </em></p>
<p><em>1.- Download and install the latest <a href="https://www.google.com/intl/en/earth/versions/#download-pro"> Google Earth Pro Desktop app for macOS (7.3.3.7786 64-bit)</a></em></p>
<p><em>2.- Open the Google Earth app and create a new Pin, add any name add click on add link, and paste this code in the white box<pre class="wp-block-code"><code>&lt;a href="file:///etc/passwd%00.html"&gt;passwd&lt;/a&gt; 
</code></pre></em></p>
<p><em>and click OK button</em></p>
<p><em>3.- After Pin&#8217;s creation, in the left side pane Places, click in the hyperlink called <span class="payload-highlight"><b>passwd</b></span> add see <span class="payload-highlight"><b>/etc/passwd</b></span> file content</em></p>
<div class="wp-block-image"><figure class="aligncenter size-large"><a href="/wp-content/uploads/2021/04/ge-lfd-macos.jpg"><img src="/wp-content/uploads/2021/04/ge-lfd-macos.jpg" alt="" class="wp-image-772"></a></figure></div>
<p><em>4.- Profit</em></p>
<p><em><b>PS. any attacker can read any file with file:/// schema and appending a null byte and dot HTML extension (%00.html)</b></em></p>
<p><em>Attack scenario<br> Any attacker can read arbitrary files on macOS through the Google Earth Pro Desktop app<br> </em></p>
<div style="text-align: center !important;"> <iframe loading="lazy" id="player" type="text/html" width="1024" height="390" src="https://www.youtube.com/embed/HBk8DaRCCFE" frameborder="0"></iframe>
</div>
<p></p>
<p></p>
<p><b>Report Timeline:</b></p>
<p><b></b></p>
<p><b>Apr 17, 2021: Sent the report to Google VRP<br> Apr 19, 2021: <img style=" height: auto; width: 16px; border-radius: 0px !important;" src="/wp-content/uploads/2021/01/download-1.png"> <b>Nice catch!</b> Bug Accepted (P4 → P2)<br> Apr 27, 2021: Got a message from Google that the issue does not meet the bar for a financial reward<br> May 05, 2021: Got a message from Google that the issue report has been closed without providing a fix (Status Won&#8217;t fix)</b></p>
<p><b><br> </b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<b></b><p>Well that’s it, share your thoughts, what do you think about how they handle that security issue? If you have any doubt, comments or suggestions just drop me a line here or on Twitter&nbsp;<a href="https://twitter.com/omespino">@omespino</a>, read you later.</p> <p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<p><b></b></p>
<div class="shared-counts-wrap after_content style-fancy">
<a href="https://www.facebook.com/sharer/sharer.php?u=/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/&amp;display=popup&amp;ref=plugin&amp;src=share_button" title="Share on Facebook" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button facebook shared-counts-no-count" data-postid="1201" data-social-network="Facebook" data-social-action="Share" data-social-target="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="18.8125" height="32" viewbox="0 0 602 1024"><path d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"></path></svg></span><span class="shared-counts-label">Facebook</span></span></a><a href="https://twitter.com/share?url=/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/&amp;text=WRITE%20UP%20%E2%80%93%20GOOGLE%20VRP%20N%2FA%3A%20Arbitrary%20local%20file%20read%20%28macOS%29%20via%20%3Ca%3E%20tag%20and%20null%20byte%20%28%2500%29%20in%20Google%20Earth%20Pro%20Desktop%20app" title="Share on Twitter" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button twitter shared-counts-no-count" data-postid="1201" data-social-network="Twitter" data-social-action="Tweet" data-social-target="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="29.71875" height="32" viewbox="0 0 951 1024"><path d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"></path></svg></span><span class="shared-counts-label">Tweet</span></span></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/" title="Share on LinkedIn" target="_blank" rel="nofollow noopener noreferrer" class="shared-counts-button linkedin shared-counts-no-count" data-postid="1201" data-social-network="LinkedIn" data-social-action="Share" data-social-target="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="27.4375" height="32" viewbox="0 0 878 1024"><path d="M199.429 357.143v566.286h-188.571v-566.286h188.571zM211.429 182.286q0.571 41.714-28.857 69.714t-77.429 28h-1.143q-46.857 0-75.429-28t-28.571-69.714q0-42.286 29.429-70t76.857-27.714 76 27.714 29.143 70zM877.714 598.857v324.571h-188v-302.857q0-60-23.143-94t-72.286-34q-36 0-60.286 19.714t-36.286 48.857q-6.286 17.143-6.286 46.286v316h-188q1.143-228 1.143-369.714t-0.571-169.143l-0.571-27.429h188v82.286h-1.143q11.429-18.286 23.429-32t32.286-29.714 49.714-24.857 65.429-8.857q97.714 0 157.143 64.857t59.429 190z"></path></svg></span><span class="shared-counts-label">LinkedIn</span></span></a><span class="shared-counts-button included_total" data-postid="1201" data-social-target="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/"><span class="shared-counts-icon-label"><span class="shared-counts-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="27.4375" height="32" viewbox="0 0 878 1024"><path d="M694.857 585.143q76 0 129.429 53.429t53.429 129.429-53.429 129.429-129.429 53.429-129.429-53.429-53.429-129.429q0-6.857 1.143-19.429l-205.714-102.857q-52.571 49.143-124.571 49.143-76 0-129.429-53.429t-53.429-129.429 53.429-129.429 129.429-53.429q72 0 124.571 49.143l205.714-102.857q-1.143-12.571-1.143-19.429 0-76 53.429-129.429t129.429-53.429 129.429 53.429 53.429 129.429-53.429 129.429-129.429 53.429q-72 0-124.571-49.143l-205.714 102.857q1.143 12.571 1.143 19.429t-1.143 19.429l205.714 102.857q52.571-49.143 124.571-49.143z"></path></svg></span><span class="shared-counts-label">Shares</span></span><span class="shared-counts-count">9</span></span>
</div>
</div>
<footer class="entry-footer"></footer><div id="comments" class="comments-area"><div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/write-up-google-vrp-n-a-arbitrary-local-file-read-macos-via-a-tag-and-null-byte-in-google-earth-pro-desktop-app/#respond" style="display:none;">Cancel reply</a></small>
</h3>
<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p>
<p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p>
<p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245"></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p> <input type="text" name="leLQY" value="" style="display: none !important;"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="1201" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p>
</form>
</div></div>
</div>
<div class="sidebar"></div></article><nav class="navigation post-navigation" aria-label="Posts"><h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links">
<div class="nav-previous"><a href="/write-up-google-vrp-n-a-ssrf-bypass-with-quadzero-in-google-cloud-monitoring/" rel="prev">Previous Post <span class="screen-reader-text">WRITE UP – GOOGLE VRP N/A: SSRF bypass with quadzero in Google Cloud Monitoring</span></a></div>
<div class="nav-next"><a href="/write-up-xss-stored-in-api-media-atlassian-com-via-doc-file-ios/" rel="next">Next Post <span class="screen-reader-text">WRITE UP – ATLASSIAN BUG BOUNTY: XSS STORED IN API.MEDIA.ATLASSIAN.COM VIA DOC FILE (IOS)</span></a></div>
</div></nav></main></div></div>
<footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info"></div></footer>
</div>
<div class="mobmenu-overlay"></div>
<div class="mob-menu-header-holder mobmenu" data-menu-display="mob-menu-slideout-over" data-open-icon="down-open" data-close-icon="up-open">
<div class="mobmenul-container"><a href="#" class="mobmenu-left-bt mobmenu-trigger-action" data-panel-target="mobmenu-left-panel" aria-label="Left Menu Button"><i class="mob-icon-menu mob-menu-icon"></i><i class="mob-icon-cancel-1 mob-cancel-button"></i></a></div>
<div class="mob-menu-logo-holder"><a href="/" class="headertext"><span>@OMESPINO</span></a></div>
<div class="mobmenur-container"></div>
</div>
<div class="mobmenu-left-alignment mobmenu-panel mobmenu-left-panel  "> <a href="#" class="mobmenu-left-bt" aria-label="Left Menu Button"><i class="mob-icon-cancel-1 mob-cancel-button"></i></a><div class="mobmenu-content"><div class="menu-menu-espanol-container"><ul id="mobmenuleft" role="menubar" aria-label="Main navigation for mobile devices"><li role="none" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1304"><a href="/es" role="menuitem" class="">BLOG EN ESPAÑOL</a></li></ul></div></div>
<div class="mob-menu-left-bg-holder"></div>
</div>
</body>
</html>